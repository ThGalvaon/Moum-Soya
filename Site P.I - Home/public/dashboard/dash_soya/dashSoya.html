<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="script.js" type="text/javascript" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <script src="https://cdn.jsdelivr.net/npm/chart.js" src="script.js"></script>
  <script src="main.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" href="./assets/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Saira:ital,wght@0,100..900;1,100..900&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;400;600;700&display=swap" rel="stylesheet">
  <title>Moum Soya - Dashboard</title>
</head>

<body>
  <div class="container_dashboard">
    <div class="sidebar">
      <div class="images">
        <img src="assets\perfil-de-usuario.png" alt="Perfil" class="profile-pic">
      </div>
      <div class="user-bar">
        <h2>Olá! XPTO</h2>
        <p>xpto@gmail.school</p>
      </div>
      <a href="#" class="button" onclick="voltar()" id="home">Voltar para Home</a>
        <a href="#" id="verAlertas" onclick="toggleAlertas()">Ver Alertas</a>
      <a href="index.html" class="button">Voltar para o Site Institucional</a>
      <p><a href="#" class="link">Suporte e Ajuda</a></p>
    </div>

    <div class="main_content">

      <div class="container_sessoes">
        <div id="todas_dash" class="container_monitorados">
          <div class="header_sessoes">
            <div class="box_kpi">
              <h4>Talhões Monitoradas:</h4>
              <p>5</p>
            </div>
            <div class="box_kpi">
              <h4>Ultima Captura:</h4>
              <p>10:00</p>
            </div>
            <div class="box_kpi">
              <h4>Alertas Ativos:</h4>
              <div class="imagem_danger_header"><span>2 !</span> </div>
            </div>
          </div>
          <div class="linha">
            <div class="box_sessao" onclick="talhaoA()"><img class="imagem_sessao" src="assets/safe.png" alt="">
              <div class="title_sec">
                <h4>Talhão 1</h4>
              </div>
            </div>
            <div class="box_sessao" onclick="talhaoB()"><img class="imagem_sessao" src="assets/danger.png" alt="">
              <div class="title_sec">
                <h4>Talhão 2</h4>
              </div>
            </div>
            <div class="box_sessao" onclick="talhaoC()"><img class="imagem_sessao" src="assets/safe.png" alt="">
              <div class="title_sec">
                <h4>Talhão 3</h4>
              </div>
            </div>
          </div>
          <div class="linha">
            <div class="box_sessao" onclick="talhaoD()"><img class="imagem_sessao" src="assets/warning.png" alt="">
              <div class="title_sec">
                <h4>Talhão 4</h4>
              </div>
            </div>
            <div class="box_sessao" onclick="talhaoE()"><img class="imagem_sessao" src="assets/safe.png" alt="">
              <div class="title_sec">
                <h4>Talhão 5</h4>
              </div>
            </div>
            <!-- <div class="box_more"><img class="imagem_mais" src="./assets/more.png" alt=""> </div> -->
          </div>
        </div>

        <div id="alertasTalhoes" style="display: none;">
          <canvas id="graficoAlertas" class="grafico_semanal"></canvas>
      </div>    
        <div id="dash_talhao" class="container_talhao">

          <div class="box_talhao">
            <div class="talhao" onclick="talhaoA()">
              <div class="imagem_talhao_safe"></div>
              <p>Talhão 1</p>
            </div>
            <div class="talhao" onclick="talhaoB()">
              <div class="imagem_talhao_danger"></div>
              <p>Talhão 2</p>
            </div>
            <div class="talhao" onclick="talhaoC()">
              <div class="imagem_talhao_safe "></div>
              <p>Talhão 3</p>
            </div>
            <div class="talhao" onclick="talhaoD()">
              <div class="imagem_talhao_warning"></div>
              <p>Talhão 4</p>
            </div>
            <div class="talhao" onclick="talhaoE()">
              <div class="imagem_talhao_safe"></div>
              <p>Talhão 5</p>
            </div>
          </div>
          <div class="box_dashboards">
            <div class="box_kpi_dash">
              <div class="kpi_dash">
                <h4>Talhão Selelecionada:</h4>
                <div style="display: flex;">
                  <p style="margin-right: 1vw;">Talhão <b id="talhao_selecionada"> </b></p>
                </div>
              </div>
              <div class="kpi_dash">
                <h4>Tempo em Alerta:</h4>
                <p id="inicio_vazamento"></p>
              </div>
              <div class="kpi_dash">
                <h4>Status:</h4>
                <p id="termino_vazamento"></p> <span id="status_mensagem" class="status_mensagem"></span>
              </div>

            </div>

            <div id="dashboardB" class="dashboard">
              <canvas class="grafico" id="chart_linha"></canvas>
            </div>

            <div id="dashboard_safe" class="dashboard">
              <canvas class="grafico" id="chart_linha_safe"></canvas>
            </div>

            <div id="dashboard_warning" class="dashboard">
              <canvas class="grafico" id="chart_linha_warning"></canvas>
            </div>
            <div id="dashboard_a" class="dashboard">
              <canvas id="sensorAnalogico"></canvas>
            </div>
          </div>
        </div>

        <!-- <div class="container_barras" id="cont_barras">
          <div class="box_barras">
            <div class="texto_ano">
              <h3>Quantidade de vazametos ao longo do ano:</h3>
              <p>Ao longo do ano de <span>2024</span>, você teve um total de <span>96</span> vazamentos, sendo o mês de
                <span>Outubro</span> o de maior número de vazamentos e o mês de <span>Agosto</span> o de menor número de
                vazamentos!
              </p>
            </div>
            <canvas class="barras_grafico" id="chart_linha_ano"></canvas>
          </div>

          <div class="box_barras">
            <div class="texto_ano">
              <h3 style="font-size: 1.3vw;;">Quantidade de vazametos no mês de outubro:</h3>
              <p>No mês de <span>outubro</span>, você teve um total de <span>15</span> vazamentos, sendo a <span>Talhão
                  A</span> a de maior número de vazamentos, tendo um total de <span>14 vazamentos</span> e a
                <span>Talhão E</span> a de menor número de vazamentos, registrando <span>1 vazamento</span>!
              </p>
            </div>
            <canvas class="barras_grafico" id="chart_barra_mes"></canvas>
          </div>
        </div> -->
      </div>
    </div>
  </div>
</body>

</html>
<script>
  var sensorAnalogico = new Chart(document.getElementById('sensorAnalogico').getContext('2d'), {
    type: 'line',
    data: {
      labels: ['06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00'],
      datasets: [
        {
          label: 'Umidade do ar',
          data: [20, 39, 40, 59, 70, 74, 68],
          borderColor: 'green',
          backgroundColor: 'green',
          borderWidth: 1
        },
        {
          label: 'Limite de umidade desejável (60%)',
          data: [70, 70, 70, 70, 70, 70, 70, 70, 70],
          borderColor: 'red',
          backgroundColor: 'rgba(0, 0, 255, 0.1)',
          borderWidth: 2,
          borderDash: [5, 5],
          pointRadius: 0
        }
      ]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          max: 100,
          title: {
            display: true,
            text: 'Umidade do ar'
          }
        },
        x: {
          title: {
            display: true,
            text: 'Horário'
          }
        }
      }
    }
  });

  // var paginacao = {};
  // var tempo = {};

  // function obterDados(grafico, endpoint) {
  //   fetch('http://localhost:3300/sensores/' + endpoint)
  //     .then(response => response.json())
  //     .then(valores => {
  //       if (paginacao[endpoint] == null) {
  //         paginacao[endpoint] = 0;
  //       }
  //       if (tempo[endpoint] == null) {
  //         tempo[endpoint] = 0;
  //       }

  //       var ultimaPaginacao = paginacao[endpoint];
  //       paginacao[endpoint] = valores.length;
  //       valores = valores.slice(ultimaPaginacao);

  //       valores.forEach((valor) => {
  //         if (grafico.data.labels.length == 10 && grafico.data.datasets[0].data.length == 10) {
  //           grafico.data.labels.shift();
  //           grafico.data.datasets[0].data.shift();
  //         }

  //         grafico.data.labels.push(tempo[endpoint]++);
  //         grafico.data.datasets[0].data.push(parseFloat(valor));
  //         grafico.update();
  //       });
  //     })
  //     .catch(error => console.error('Erro ao obter dados:', error));
  // }
  // setInterval(() => {
  //   obterDados(sensorAnalogico, 'analogico');
  // }, 1000);
</script>